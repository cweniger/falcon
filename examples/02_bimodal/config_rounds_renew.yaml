# Logging configuration
logging:
  wandb:
    enabled: false
    project: falcon_examples
    group: 02_bimodal_rounds_renew
    dir: ${hydra:run.dir}
  local:
    enabled: true
    dir: ${paths.graph}

# Directory configuration (relative to Hydra output directory)
paths:
  import: "./src"
  buffer: ${hydra:run.dir}/sim_dir
  graph: ${hydra:run.dir}/graph_dir

# Training buffer parameters
buffer:
  min_training_samples: 8000
  max_training_samples: 8000
  validation_window_size: 256
  resample_batch_size: 8000
  keep_resampling: true
  resample_interval: 600

# Graph definition using declarative YAML
graph:
  z:
    evidence: [x]
    simulator: 
      _target_: falcon.contrib.HypercubeMappingPrior
      priors: 
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
        - ['uniform', -10000.0, 10000.0]
    estimator:
      _target_: falcon.contrib.SNPE_A
      embedding:
         _target_: model.E
         _input_: [x]
      net_type: nsf  # zuko_gf, maf, nice, sospf, naf, gf
      theta_norm: true
      use_log_update: true
      adaptive_momentum: false
      norm_momentum: 0.002
      
      num_epochs: 600
      batch_size: 128
      lr: 0.006
      early_stop_patience: 32
      lr_decay_factor: 0.5
      scheduler_patience: 16
      
      gamma: 0.5
      discard_samples: false
      log_ratio_threshold: -20

      sample_reference_posterior: false
      use_best_models_during_inference: true
      reset_network_after_pause: false
    ray:
      num_gpus: 1
  
  m:
    parents: [z]
    simulator: model.Signal

  n:
    simulator: model.Noise

  x:
    parents: [m, n]
    simulator: model.Add
    observed: "./data/x_obs_10dim.npy"

sample:
  prior:
    n: 1000
    path: samples_prior.joblib
  proposal:
    n: 1000
    path: samples_proposal.joblib
  posterior:
    n: 1000
    path: samples_posterior.joblib
